schema: spec-driven

# Project context (optional)
# This is shown to AI when creating artifacts.
context: |
  ## Purpose
  Assembly Line is a daemon that orchestrates coding agents in a station-based pipeline. Each agent focuses on a single quality station (security, deduplication, style, etc.). Changes flow through a directed graph of stations, with Git providing the audit trail and intent preservation.

  ## Tech Stack
  - Go (daemon implementation)
  - Git (version control, worktrees, notes)
  - YAML (configuration)
  - Claude Code CLI (default agent, configurable)
  - Ginkgo + Gomega (testing framework)

  ## Project Conventions

  ### Code Style
  - Go standard formatting (`gofmt`)
  - Error handling: wrap errors with context
  - Logging: structured logging with levels

  ### Architecture Patterns
  - DAG for station ordering
  - Polling model for branch watching
  - Worktree isolation per station
  - Git notes for audit trail

  ### Testing Strategy
  - **Framework:** Ginkgo + Gomega, BDD/RSpec style
  - **Structure:** `Describe`/`Context`/`It` blocks with descriptive specs
  - **Style:** Favor readability; specs should read like documentation

  ### Development Approach
  - **Thin vertical slices:** Each increment delivers end-to-end functionality
  - **Outside-in:** Acceptance tests drive the compiled binary; no mocks at the boundary
  - **No horizontal layers:** Don't build "all config parsing" then "all git ops" - build working features
  - **Each slice = acceptance test:** Work isn't done until there's a passing test exercising the binary

  ### Git Workflow
  - Trunk-based development on `main`
  - Feature branches for significant changes
  - Commit messages: imperative mood, concise

  ## Domain Context
  - **Station**: A single-purpose agent focus (e.g., "fix security issues")
  - **Station Graph**: DAG of stations, upstream to downstream
  - **Intent Preservation**: Downstream agents respect upstream work via commit context
  - **Implicit Priority**: Position in graph implies precedence

  ## Important Constraints
  - Must work with standard Git (no special server)
  - Must handle agent failures gracefully
  - Must not lose commits or create orphan branches
  - Must provide clear audit trail via git log

  ## External Dependencies
  - Git CLI (2.20+ for worktree features)
  - Claude Code CLI (or configurable alternative)

# Per-artifact rules (optional)
# Add custom rules for specific artifacts.
# Example:
#   rules:
#     proposal:
#       - Keep proposals under 500 words
#       - Always include a "Non-goals" section
#     tasks:
#       - Break tasks into chunks of max 2 hours
