{"id":"detergent-0mo","title":"Change status --follow to only refresh when state changes to avoid flickering","status":"closed","priority":2,"issue_type":"bug","owner":"daniel@ajps.limited","created_at":"2026-02-14T22:02:10.062297Z","created_by":"Daniel Jones","updated_at":"2026-02-14T22:07:51.110758Z","closed_at":"2026-02-14T22:07:51.110758Z","close_reason":"Closed"}
{"id":"detergent-0qe","title":"permissions","description":"allow detergent.yaml to define a block of permissions that matches the Claude Code permissions configuration found in .claude/settings.json. We can write this file in eeach temp working directory that we invoke Claude Code in for each concern. It should be optional.\n","status":"closed","priority":3,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T07:40:34.164241Z","created_by":"Daniel Jones","updated_at":"2026-02-15T07:46:15.32877Z","closed_at":"2026-02-15T07:46:15.32877Z","close_reason":"Closed"}
{"id":"detergent-0tn","title":"ci integration tests","description":"assuming that we actually have integration tests, make sure they are invoked in CI, and that the job passes in CLAUDE_CODE_OAUTH_TOKEN","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T10:49:48.024282Z","created_by":"Daniel Jones","updated_at":"2026-02-15T11:07:01.132622Z","closed_at":"2026-02-15T11:07:01.132622Z","close_reason":"Integration job now runs acceptance tests with CLAUDE_CODE_OAUTH_TOKEN from secrets. Ready for Claude-based integration tests when written."}
{"id":"detergent-32t","title":"settings refresh","description":"change detergent run to poll/watch the settings files for changes, and reconfigure itself dynamically.","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T08:39:40.794626Z","created_by":"Daniel Jones","updated_at":"2026-02-15T10:26:21.429003Z","closed_at":"2026-02-15T10:26:21.429003Z","close_reason":"Daemon now reloads config every poll cycle. Invalid configs logged and skipped. Poll interval changes reset the ticker automatically. 75/75 tests pass."}
{"id":"detergent-3fv","title":"Remove unused/dead code","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T08:33:46.51963Z","created_by":"Daniel Jones","updated_at":"2026-02-15T08:59:52.518369Z","closed_at":"2026-02-15T08:59:52.518369Z","close_reason":"No dead code found. Both deadcode and staticcheck tools report clean. All 74 acceptance tests pass. Manual analysis confirmed all functions, types, variables, and constants are reachable and used."}
{"id":"detergent-4uo","title":"remove any dead code","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-14T22:25:41.970177Z","created_by":"Daniel Jones","updated_at":"2026-02-14T22:28:22.150757Z","closed_at":"2026-02-14T22:28:22.150757Z","close_reason":"Closed"}
{"id":"detergent-69j","title":"update readme","description":"update the readme to ensure all features are documented","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-14T22:24:17.538241Z","created_by":"Daniel Jones","updated_at":"2026-02-14T22:33:08.965642Z","closed_at":"2026-02-14T22:33:08.965642Z","close_reason":"Closed"}
{"id":"detergent-7gp","title":"Remove unused code (deadcode sweep)","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T08:23:42.875037Z","created_by":"Daniel Jones","updated_at":"2026-02-15T08:54:50.418474Z","closed_at":"2026-02-15T08:54:50.418474Z","close_reason":"No dead code found. Both deadcode and staticcheck tools report clean. Manual analysis confirmed all functions, types, variables, and constants are reachable and used."}
{"id":"detergent-7vk","title":"ci","description":"release should only follow successful integration tests in ci","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T10:48:29.948903Z","created_by":"Daniel Jones","updated_at":"2026-02-15T11:07:01.169872Z","closed_at":"2026-02-15T11:07:01.169872Z","close_reason":"Release job now depends on [lint, test, build, integration]. Release won't proceed until integration tests pass."}
{"id":"detergent-84l","title":"website","description":"Clone git@github.com:re-cinq/wave.git and look at its website - I tihnk it's in Docs. Create an aesthetically-matching equivalent for detergent, but don't deploy it anywhere. Figure out how Wave deploys its site, and then use plan mode to describe the various ways we could make a low-effort site deployment. Write this to our repo, but don't commit it.","status":"closed","priority":4,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T06:55:27.698509Z","created_by":"Daniel Jones","updated_at":"2026-02-15T16:41:09.738487Z","closed_at":"2026-02-15T16:41:09.738487Z","close_reason":"Website created in docs/ matching Wave aesthetic. Content pages: index, guide, getting-started, configuration, claude-code. Deployment plan written to docs/DEPLOYMENT.md covering GitHub Pages, Cloudflare Pages, Netlify, Vercel. Not committed per issue instructions."}
{"id":"detergent-9pe","title":"status follow logs","description":"I'm not sure the logs are scrolling properly in status follow mode. I was kinda expecting to see a 'window' of three lines scrolling within the status follow output. I think maybe it's not refreshing, because of the previous instruction to only update the view when status changes? We'll need to instead redraw whenever the logs change too.\n","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T06:58:25.252257Z","created_by":"Daniel Jones","updated_at":"2026-02-15T07:34:18.737634Z","closed_at":"2026-02-15T07:34:18.737634Z","close_reason":"Closed"}
{"id":"detergent-aw3","title":"status colours","description":"Can we have  use the same colours as the statusline? Especially in follow mode?","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T06:56:34.594716Z","created_by":"Daniel Jones","updated_at":"2026-02-15T07:25:38.0174Z","closed_at":"2026-02-15T07:25:38.0174Z","close_reason":"Closed"}
{"id":"detergent-b6a","title":"Deduplicate repeated error wrapping patterns","description":"Extract common fmt.Errorf wrapping patterns into helper functions. Found 20+ occurrences across engine/state.go, engine/engine.go, config/config.go, and cli/install.go. Create internal/errors package with context-aware error wrapping.","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T10:05:38.31066Z","created_by":"Daniel Jones","updated_at":"2026-02-15T10:24:58.677387Z","closed_at":"2026-02-15T10:24:58.677387Z","close_reason":"Premature abstraction. These are 2-3 line idiomatic Go patterns (MkdirAll+WriteFile, os.IsNotExist, fmt.Errorf). Creating helpers adds indirection without meaningful benefit at this codebase size."}
{"id":"detergent-bv9","title":"debugging","description":"Make it easier to figure out why nothing seems to be happening. Do we know where logs, STDOUT and STDERR for each invocation go? Maybe we can add a `detergent logs \u003cconcern\u003e \u003ccommit\u003e` command or something to open those in a convenient fashion? Ooh! Maybe we could also have `detergent status -f` tail the last few lines of the logs?\n","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-14T22:30:56.231535Z","created_by":"Daniel Jones","updated_at":"2026-02-14T22:49:10.26889Z","closed_at":"2026-02-14T22:49:10.26889Z","close_reason":"Closed"}
{"id":"detergent-d96","title":"Remove dead code from codebase","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T08:24:49.096755Z","created_by":"Daniel Jones","updated_at":"2026-02-15T08:33:22.085254Z","closed_at":"2026-02-15T08:33:22.085254Z","close_reason":"No dead code found. Both deadcode and staticcheck tools report clean. Manual analysis confirmed all functions, types, variables, and constants are reachable and used."}
{"id":"detergent-e5q","title":"Auto-inject non-interactive preamble into agent prompts","description":"Detergent knows the agent is always non-interactive, so it should automatically prepend something like 'You are running non-interactively. Do not ask questions or wait for confirmation.' to every concern prompt. This removes the burden from users having to include it manually in every prompt.","status":"closed","priority":3,"issue_type":"feature","owner":"daniel@ajps.limited","created_at":"2026-02-15T10:06:35.515433Z","created_by":"Daniel Jones","updated_at":"2026-02-15T16:40:20.680719Z","closed_at":"2026-02-15T16:40:20.680719Z","close_reason":"Removed redundant non-interactive preambles from concern prompts in detergent.yaml since they are now auto-injected by assembleContext()"}
{"id":"detergent-ef9","title":"Status command should validate PID liveness for active states","description":"The status and statusline commands trust the state field in the status JSON, but if the daemon crashes or is killed mid-run, the file still says agent_running forever. Since the PID is already recorded, check if the process is still alive (kill -0) and show a stale/crashed state if it's dead. Affects states: change_detected, agent_running, committing.","status":"closed","priority":2,"issue_type":"feature","owner":"daniel@ajps.limited","created_at":"2026-02-14T22:43:04.145197Z","created_by":"Daniel Jones","updated_at":"2026-02-14T22:47:12.83066Z","closed_at":"2026-02-14T22:47:12.83066Z","close_reason":"Closed"}
{"id":"detergent-ell","title":"Make detergent status more granular for debugging","description":"Current status output isn't granular enough to debug issues like agent hangs. Proposed lifecycle states: 'change detected' (was 'pending'), 'agent started' (command invoked), 'agent succeeded' (exit 0), 'agent failed' (non-zero exit). Possibly also 'change committed'. Goal: be able to tell at a glance where in the pipeline a concern is stuck.","status":"closed","priority":2,"issue_type":"feature","owner":"daniel@ajps.limited","created_at":"2026-02-14T22:21:23.176741Z","created_by":"Daniel Jones","updated_at":"2026-02-14T22:25:32.975088Z","closed_at":"2026-02-14T22:25:32.975088Z","close_reason":"Closed"}
{"id":"detergent-fo8","title":"dedupe","description":"deduplicate any code, including in tests. Don't remove test *coverage* though.","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-14T22:26:18.396981Z","created_by":"Daniel Jones","updated_at":"2026-02-14T22:52:45.804202Z","closed_at":"2026-02-14T22:52:45.804202Z","close_reason":"Closed"}
{"id":"detergent-i3n","title":"releases","description":"Copy the strategy for releasing from https://github.com/re-cinq/claudit. We want patch revisions to get bumped, and releases for all architectures to be pushed to GitHub releases. There should be GitHub Actions that run the tests, and linting and stuff.","status":"closed","priority":3,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T08:14:54.550821Z","created_by":"Daniel Jones","updated_at":"2026-02-15T13:41:39.934634Z","closed_at":"2026-02-15T13:41:39.934634Z","close_reason":"Already implemented: CI pipeline (lint, test, build, integration, auto-release), GoReleaser config, bump-version workflow all in place. v0.0.1 released successfully."}
{"id":"detergent-i48","title":"commits","description":"I don't think I've seen detergent actually make any commits as a result of agent action. Can you investigate this? Do we have any proper end-to-end integration tests that really prove that it all works?","status":"closed","priority":1,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T07:12:23.486901Z","created_by":"Daniel Jones","updated_at":"2026-02-15T07:23:26.760297Z","closed_at":"2026-02-15T07:23:26.760297Z","close_reason":"Fixed: invokeAgent now pipes context to stdin so claude -p receives the actual prompt. Added test verifying stdin piping."}
{"id":"detergent-j57","title":"rename skill","description":"We should prolly namespace the skill to be /detergent/rebase. I don't know if that's descriptive enough of the outcome though... Rebasing is the implementation method, but really the user is 'getting changes' or something.\n\n","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T15:45:23.938526Z","created_by":"Daniel Jones","updated_at":"2026-02-15T16:33:37.450661Z","closed_at":"2026-02-15T16:33:37.450661Z","close_reason":"Renamed skill from /rebase to /detergent-rebase, updated hint and description"}
{"id":"detergent-kh1","title":"license","description":"Adopt the AI Native Application License - https://github.com/re-cinq/ai-native-application-license. Link to the repo containing the license in the README, as well as to our LICENSE file itself.","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T06:51:38.618766Z","created_by":"Daniel Jones","updated_at":"2026-02-15T07:24:26.541976Z","closed_at":"2026-02-15T07:24:26.541976Z","close_reason":"Closed"}
{"id":"detergent-lie","title":"install script","description":"Make an install bash script that can be run via curl, as per https://github.com/re-cinq/claudit. We should also test this script so we know that it works.","status":"closed","priority":3,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T08:16:13.230377Z","created_by":"Daniel Jones","updated_at":"2026-02-15T14:21:10.255097Z","closed_at":"2026-02-15T14:21:10.255097Z","close_reason":"Added Docker-based install script test and CI job. Install script already existed; improved shebang and added usage header.","dependencies":[{"issue_id":"detergent-lie","depends_on_id":"detergent-i3n","type":"blocks","created_at":"2026-02-15T08:16:13.231111Z","created_by":"Daniel Jones"}]}
{"id":"detergent-lqr","title":"change github org","description":"I'll move this to the re-cinq github org. Can you change all the packages?","status":"closed","priority":1,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T10:12:41.083048Z","created_by":"Daniel Jones","updated_at":"2026-02-15T10:23:04.308634Z","closed_at":"2026-02-15T10:23:04.308634Z","close_reason":"Renamed module from github.com/fission-ai/detergent to github.com/re-cinq/detergent across all 15 Go files, goreleaser, Makefile, README, and install script. 75/75 tests pass."}
{"id":"detergent-o4f","title":"default config","description":"All commands that take the path of a detergent YAML config file should default to detergent.yaml. We should probably change any positional file path arguments to be named (-p and --path?)","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T06:59:38.295817Z","created_by":"Daniel Jones","updated_at":"2026-02-15T07:34:18.739487Z","closed_at":"2026-02-15T07:34:18.739487Z","close_reason":"Closed"}
{"id":"detergent-pi8","title":"detergent ignore","description":"we should probably allow for users to indicate that they don't want detergent to process a master branch commit. IIRC there's some convention about [SKIPCI] or something. Could we do that, and also one specific for detergent? And then if either is present, we don't process the commit?","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T10:15:09.218191Z","created_by":"Daniel Jones","updated_at":"2026-02-15T10:24:37.914126Z","closed_at":"2026-02-15T10:24:37.914126Z","close_reason":"Added skip marker support. Commits with [skip ci], [ci skip], [skip detergent], or [detergent skip] are skipped. All 75 tests pass."}
{"id":"detergent-r30","title":"graph to list","description":"To simplify things for now, let's change the UX so the chain of concerns is an ordered list, and not a graph. That means we don't need the 'watches' key in the YAML any more, and simplifies things. However, inside the app, I'd like it to remain modelled as a graph so we can add this feature back in later as a breaking change and major revision. Once done the README will need updating.","status":"closed","priority":1,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T10:54:00.575066Z","created_by":"Daniel Jones","updated_at":"2026-02-15T11:06:10.830309Z","closed_at":"2026-02-15T11:06:10.830309Z","close_reason":"Concerns now defined as ordered list. First watches settings.watches (default 'main'), each subsequent watches the previous. Explicit watches still accepted for backward compat. Internal graph model preserved. 75/75 tests pass."}
{"id":"detergent-rsk","title":"Deduplicate file existence check patterns","description":"Create ReadIfExists helper in internal/fsutil to consolidate os.IsNotExist checks found in engine/state.go (2x), engine/engine.go, and cli/logs.go.","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T10:05:40.60531Z","created_by":"Daniel Jones","updated_at":"2026-02-15T10:24:58.656665Z","closed_at":"2026-02-15T10:24:58.656665Z","close_reason":"Premature abstraction. These are 2-3 line idiomatic Go patterns (MkdirAll+WriteFile, os.IsNotExist, fmt.Errorf). Creating helpers adds indirection without meaningful benefit at this codebase size."}
{"id":"detergent-sqf","title":"check test coverage","description":"make sure we've got test coverage for all the new features","notes":"Coverage assessment complete. 64 acceptance tests pass. Key gaps: (1) New granular states (change_detected, agent_running, committing) have zero test coverage, (2) statusline normalization edge cases partially tested, (3) rebaseHint logic untested, (4) status --follow flag untested, (5) install command has 0% coverage, (6) config validation edge cases (duplicate names, empty concerns, invalid durations) not tested. No unit tests exist - all testing is acceptance/integration.","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-14T22:23:50.746334Z","created_by":"Daniel Jones","updated_at":"2026-02-14T22:32:30.791942Z","closed_at":"2026-02-14T22:32:30.791942Z","close_reason":"Audit complete - gaps documented, follow-up issue to be created for writing tests"}
{"id":"detergent-t90","title":"Deduplicate WriteFile with MkdirAll pattern","description":"Create WriteFileWithDir helper in internal/fsutil for MkdirAll + WriteFile pattern. Found 5+ occurrences in engine/state.go, engine/engine.go, and cli/install.go.","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T10:05:41.487719Z","created_by":"Daniel Jones","updated_at":"2026-02-15T10:24:58.645676Z","closed_at":"2026-02-15T10:24:58.645676Z","close_reason":"Premature abstraction. These are 2-3 line idiomatic Go patterns (MkdirAll+WriteFile, os.IsNotExist, fmt.Errorf). Creating helpers adds indirection without meaningful benefit at this codebase size."}
{"id":"detergent-tda","title":"Add PTY support to invokeAgent for real-time log tailing","description":"Claude CLI buffers stdout when writing to a file (non-TTY). This means detergent status -f can't show real-time agent output - logs only appear after the agent finishes. Fix by using a PTY (e.g. creack/pty) in invokeAgent so the child process thinks it's writing to a terminal and uses line buffering instead.","status":"closed","priority":3,"issue_type":"feature","owner":"daniel@ajps.limited","created_at":"2026-02-15T09:08:39.582521Z","created_by":"Daniel Jones","updated_at":"2026-02-15T15:57:10.727234Z","closed_at":"2026-02-15T15:57:10.727234Z","close_reason":"PTY support added to invokeAgent. Stdout/stderr now use a PTY so agents see a terminal and line-buffer output. Stdin stays as a pipe for proper EOF."}
{"id":"detergent-tin","title":"Write tests for untested functionality","description":"Coverage audit (detergent-sqf) found these gaps: (1) Granular lifecycle states (change_detected, agent_running, committing) - zero coverage, (2) Statusline normalization (idle+caught_up→noop, idle+behind→pending), (3) rebaseHint logic, (4) status --follow flag, (5) install command, (6) config validation edge cases. See detergent-sqf notes for full details.","status":"closed","priority":3,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-14T22:32:39.177206Z","created_by":"Daniel Jones","updated_at":"2026-02-14T22:54:55.107873Z","closed_at":"2026-02-14T22:54:55.107873Z","close_reason":"Closed"}
{"id":"detergent-z59","title":"separate help text","description":"the help for commands should be split into two - one for humans, and one for agents. I don't think humans will want to run statusline, statusline-data. Also, the help text makes reference to a graph, and it's a chain now.","status":"closed","priority":2,"issue_type":"task","owner":"daniel@ajps.limited","created_at":"2026-02-15T16:04:31.08156Z","created_by":"Daniel Jones","updated_at":"2026-02-15T16:28:47.299211Z","closed_at":"2026-02-15T16:28:47.299211Z","close_reason":"Hidden statusline/statusline-data from help, fixed graph→chain wording throughout CLI"}
